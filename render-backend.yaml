services:
  # FastAPI Backend Service (Render)
  - type: web
    name: brain-tumor-api
    env: python
    region: virginia
    plan: free

    # Repository
    repo: YOUR_GITHUB_REPO_URL
    branch: main

    # Build command: install dependencies only
    buildCommand: pip install --upgrade pip setuptools && pip install --no-cache-dir -r requirements.txt

    # Start command: use $PORT environment variable (provided by Render)
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT

    # Environment variables - set these in Render dashboard
    envVars:
      # MongoDB Atlas
      - key: MONGO_URI
        scope: build,runtime
        sync: false
      
      # Backend Public URL (for generating absolute image URLs)
      # Set this to your Render backend URL after deployment begins
      # Example: https://brain-tumor-api.onrender.com
      - key: BACKEND_URL
        scope: build,runtime
        sync: false
      
      # CORS Origins (comma-separated)
      # Allow localhost for development, add your Netlify frontend domain
      # Example: http://localhost:3000,http://localhost:5174,https://my-app.netlify.app
      - key: CORS_ORIGINS
        value: "http://localhost:3000,http://localhost:5174"
        scope: build,runtime
        sync: false
      
      # Model and inference settings
      - key: MODEL_NAME
        value: "brain_tumor_model.h5"
        scope: build,runtime
        sync: false
      
      - key: IMAGE_SIZE
        value: "224"
        scope: build,runtime
        sync: false
      
      - key: MAX_UPLOAD_SIZE
        value: "10485760"
        scope: build,runtime
        sync: false
      
      - key: CONFIDENCE_THRESHOLD
        value: "0.5"
        scope: build,runtime
        sync: false
      
      # Auth settings
      - key: SECRET_KEY
        scope: build,runtime
        sync: false
      
      - key: JWT_ALGORITHM
        value: "HS256"
        scope: build,runtime
        sync: false
      
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: "60"
        scope: build,runtime
        sync: false
      
      # Email/SendGrid for password reset (optional)
      - key: SENDGRID_API_KEY
        scope: build,runtime
        sync: false
      
      - key: SENDGRID_FROM_EMAIL
        scope: build,runtime
        sync: false
      
      # Logging
      - key: LOG_LEVEL
        value: "INFO"
        scope: build,runtime
        sync: false
      
      # Database name
      - key: MONGO_DB_NAME
        value: "neuro_assist"
        scope: build,runtime
        sync: false
